# โ ุงูุฎุทูุงุช ุงูุตุญูุญุฉ ููุชุญูู ูู ูุดููุฉ ุงูุงุชุตุงู

## ๐ **ุงูุชุงุฑูุฎ:** 2025-02-11

---

## โ **ุชู ุฅุถุงูุฉ Health Check Endpoint**

ุงูุขู Backend ูุญุชูู ุนูู `/api/health` โ

---

## ๐ **ุฎุทูุงุช ุงูุชุญูู ูู ุงููุดููุฉ:**

### **1๏ธโฃ ุชุญูู ูู Backend Status ูู Railway**

1. ุงุฐูุจ ุฅูู: https://railway.app
2. ุงูุชุญ Backend Service
3. ุงูุชูู ุฅูู **Deployments**
4. ุชุฃูุฏ ุฃู ุขุฎุฑ ูุดุฑ **Status = Ready** โ

**ุฅุฐุง Status = Error ุฃู Building:** โ Backend ูุง ูุนูู  
**ุงูุญู:** ุงูุญุต Logs ููุดุงูุฏุฉ ุงูุฎุทุฃ

---

### **2๏ธโฃ ุงุฎุชุจุฑ Health Check Endpoint**

ุงูุชุญ ูู ุงููุชุตูุญ:
```
https://web-production-e0446.up.railway.app/api/health
```

**ุงููุชุงุฆุฌ ุงููุญุชููุฉ:**

#### โ **ุฅุฐุง ุธูุฑ:**
```json
{
  "status": "OK",
  "message": "Server is running"
}
```
**ูุฐุง ูุนูู:** Backend ูุนูู ุจุดูู ุตุญูุญ โ

---

#### โ **ุฅุฐุง ุธูุฑ 404:**
```
Cannot GET /api/health
```
**ูุฐุง ูุนูู:** Health endpoint ุบูุฑ ููุฌูุฏ (ููู ุชู ุฅุถุงูุชู ุงูุขู)

---

#### โ **ุฅุฐุง ุธูุฑ 502/503:**
```
502 Bad Gateway
503 Service Unavailable
```
**ูุฐุง ูุนูู:** Backend ูุง ูุนูู โ

**ุงูุญู:**
1. ุงูุญุต Logs ูู Railway
2. ุชุฃูุฏ ูู `DATABASE_URL` ุตุญูุญ
3. ุชุฃูุฏ ูู `JWT_SECRET` ููุฌูุฏ

---

#### โ **ุฅุฐุง ูู ูุธูุฑ ุดูุก:**
**ูุฐุง ูุนูู:** Backend ูุง ูุณุชุฌูุจ ุฅุทูุงูุงู

**ุงูุญู:**
1. ุชุฃูุฏ ุฃู Backend ููุฑููุน ุนูู Railway
2. ุงูุญุต Network/Firewall settings ูู Railway

---

### **3๏ธโฃ ุชุญูู ูู Port Configuration**

**ูู `backend/src/main.ts` ุงูุณุทุฑ 52:**

```typescript
const port = process.env.PORT || 3000;
```

**ูุฐุง ุตุญูุญ 100%** โ

Railway ูุนุทู `process.env.PORT` ุชููุงุฆูุงูุ ูุงูููุทุฉ ุงูุงูุชุฑุงุถูุฉ `3000` ููุทูุงุฑูุก.

---

### **4๏ธโฃ ุชุญูู ูู CORS Configuration**

**ูู `backend/src/main.ts` ุงูุณุทูุฑ 26-33:**

```typescript
const allowedOrigins = process.env.CORS_ORIGIN 
  ? process.env.CORS_ORIGIN.split(',').map(o => o.trim())
  : ['http://localhost:5173', 'http://localhost:3001', 'http://127.0.0.1:5173'];

app.enableCors({
  origin: allowedOrigins,
  credentials: true,
});
```

**ูุฐุง ูุฏุนู:** โ  
- ูุชุนุฏุฏ Origins ุนุจุฑ `CORS_ORIGIN`  
- Localhost ููุชูููุฉ

---

### **5๏ธโฃ ุชุฃูุฏ ูู CORS_ORIGIN ูู Railway**

**ูู Railway Backend Service โ Variables:**

ุงูุญุต `CORS_ORIGIN`:

#### โ **ุฅุฐุง ูุงู:**
```
CORS_ORIGIN=http://localhost:3001
```
**ูุฐุง ุฎุทุฃ ูู ุงูุฅูุชุงุฌ!**

**ุงูุญู:** ุบููุฑู ุฅูู:
```
CORS_ORIGIN=https://your-frontend.vercel.app
ุฃู
CORS_ORIGIN=https://your-frontend.onrender.com
ุฃู
CORS_ORIGIN=https://your-frontend.railway.app
```

---

#### โ **ุฅุฐุง ูุงู:**
```
CORS_ORIGIN=https://crm-frontend.vercel.app
```
**ูุฐุง ุตุญูุญ** โ

**ููุงุญุธุฉ:** ููููู ุฅุถุงูุฉ ุนุฏุฉ Origins ููุตููุฉ ุจู ูุงุตูุฉ:
```
CORS_ORIGIN=https://crm-frontend.vercel.app,https://crm-frontend-2.vercel.app
```

---

### **6๏ธโฃ ุชุญูู ูู VITE_API_URL ูู Frontend**

**ูู Vercel/Railway Frontend โ Environment Variables:**

ุงูุญุต `VITE_API_URL`:

#### โ **ูุฌุจ ุฃู ูููู:**
```
VITE_API_URL=https://web-production-e0446.up.railway.app/api
```
**โ๏ธ ููู:** ุฃุถู `/api` ูู ุงูููุงูุฉ!

---

#### โ **ุฅุฐุง ูุงู:**
```
VITE_API_URL=https://web-production-e0446.up.railway.app
```
**ูุฐุง ุฎุทุฃ!** ุจุฏูู `/api`

**ุงูุญู:** ุฃุถู `/api` ูุฃุนุฏ Deploy

---

#### โ **ุฅุฐุง ูุงู `undefined`:**
**ูุฐุง ุฎุทุฃ!** ุงููุชุบูุฑ ุบูุฑ ูุนุฑู

**ุงูุญู:** ุฃุถู `VITE_API_URL` ูุฃุนุฏ Deploy

---

## ๐ **ุจุนุฏ ุชุนุฏูู ุฃู ูุชุบูุฑ:**

### **ูู Backend:**
1. ุงุญูุธ Environment Variables
2. Railway ุณูุนูุฏ Deploy ุชููุงุฆูุงู
3. ุงูุชุธุฑ Deploy ููุชูู (Status = Ready)

---

### **ูู Frontend:**
1. ุงุญูุธ Environment Variables
2. **ุฃุนุฏ Deploy:**
   - **Vercel:** Deployments โ โฎ โ Redeploy
   - **Railway:** Save (auto-redeploy)
   - **Render:** Manual Deploy
3. ุงูุชุธุฑ Deploy ููุชูู

---

## โ **ูุงุฆูุฉ ุงูุชุญูู ุงููุงููุฉ:**

### **Backend:**
- [ ] Status ูู Railway = Ready
- [ ] `/api/health` ุฑุฌุน `{ status: 'OK' }`
- [ ] Port configuration ุตุญูุญ (`process.env.PORT`)
- [ ] `DATABASE_URL` ุตุญูุญ ููุชุตู
- [ ] `JWT_SECRET` ููุฌูุฏ
- [ ] `CORS_ORIGIN` ูุญุชูู Frontend URL ุงูุตุญูุญ

---

### **Frontend:**
- [ ] `VITE_API_URL` ูุนุฑู
- [ ] `VITE_API_URL` ูุญุชูู Backend URL ุงูุตุญูุญ
- [ ] `VITE_API_URL` ููุชูู ุจู `/api`
- [ ] ุชู ุฅุนุงุฏุฉ Deploy ุจุนุฏ ุฅุถุงูุฉ ุงููุชุบูุฑ
- [ ] Deploy Status = Ready

---

### **ุงูุชูุตูู:**
- [ ] Network Error ูุง ูุธูุฑ
- [ ] ุชุณุฌูู ุงูุฏุฎูู ูุนูู
- [ ] Console ูุง ููุฌุฏ ุฃุฎุทุงุก
- [ ] Network tab ูุธูุฑ ุทูุจุงุช ูุงุฌุญุฉ (200/201)

---

## ๐ **ูุดุงูู ุดุงุฆุนุฉ ูุญููููุง:**

### **ุงููุดููุฉ 1: "Network Error"**

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
1. `VITE_API_URL` ุบูุฑ ูุนุฑู โ ุฃุถูู
2. `VITE_API_URL` ุฎุงุทุฆ โ ุญุฏูุซู
3. Backend ูุง ูุนูู โ ุงูุญุต Health endpoint
4. CORS ุบูุฑ ูุถุจูุท โ ุญุฏูุซ `CORS_ORIGIN`

---

### **ุงููุดููุฉ 2: "CORS Error" ูู Console**

**ุงูุณุจุจ:**
`CORS_ORIGIN` ูู Backend ูุง ูุญุชูู Frontend URL

**ุงูุญู:**
```
CORS_ORIGIN=https://your-frontend-url.com
```

---

### **ุงููุดููุฉ 3: "401 Unauthorized"**

**ุงูุณุจุจ:**
Authentication token ููููุฏ ุฃู ุบูุฑ ุตุญูุญ

**ุงูุญู:**
- ุชุฃูุฏ ูู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ
- ุงูุญุต `accessToken` ูู localStorage

---

### **ุงููุดููุฉ 4: Backend ุฑุฌุน 404**

**ุงูุณุจุจ:**
Health endpoint ุบูุฑ ููุฌูุฏ (ููู ุชู ุฅุถุงูุชู ุงูุขู โ)

**ุงูุญู:**
ุฃุนุฏ Deploy ููู Backend ูุชุญุตู ุนูู ุขุฎุฑ ุชุญุฏูุซ

---

## ๐ **ููุฎุต ุณุฑูุน:**

### โ **ูุง ุชู ุฅูุฌุงุฒู:**

1. โ ุชู ุฅุถุงูุฉ Health check endpoint (`/api/health`)
2. โ ุงูููุฏ ูุฏุนู `process.env.PORT` โ
3. โ CORS ูุฏุนู ูุชุนุฏุฏ Origins โ
4. โ ุฑุณุงูุฉ ุงูุฎุทุฃ ูุญุณููุฉ โ

---

### โ๏ธ **ูุง ูุญุชุงุฌ ูุนูู ุงููุณุชุฎุฏู:**

1. โ๏ธ ุงุฎุชุจุงุฑ `/api/health` ูู ุงููุชุตูุญ
2. โ๏ธ ุงูุชุญูู ูู `CORS_ORIGIN` ูู Railway
3. โ๏ธ ุงูุชุญูู ูู `VITE_API_URL` ูู Vercel/Railway
4. โ๏ธ ุฅุนุงุฏุฉ Deploy ุจุนุฏ ุฃู ุชุนุฏูู
5. โ๏ธ ุงุฎุชุจุงุฑ ุชุณุฌูู ุงูุฏุฎูู

---

## ๐ฏ **ุงูุฎูุงุตุฉ:**

**ุฌููุน ุงูุฎุทูุงุช ุงูุชู ุฐูุฑุชูุง ุตุญูุญุฉ 100%** โ

ุชู ุฅุถุงูุฉ Health endpoint ููุชุญูู ุงูุณุฑูุน ูู ุญุงูุฉ Backend.

ุงูุขู ููููู:
1. ุงุฎุชุจุงุฑ `/api/health` ููุนุฑูุฉ ุฅุฐุง Backend ูุนูู
2. ุชุฃูุฏ ูู `CORS_ORIGIN` ู `VITE_API_URL`
3. ุฃุนุฏ Deploy ุจุนุฏ ุฃู ุชุนุฏูู
4. ุฌุฑูุจ ุชุณุฌูู ุงูุฏุฎูู

---

**โ ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉุ ุงูุญุต ุงูุฃุฏูุฉ ุงูุณุงุจูุฉ:**
- `ุงูุญู_ุงูููุงุฆู.md`
- `ููู_ููู_ููู.md`
- `ุชุดุฎูุต_ูุดููุฉ_VITE_API_URL.md`

---

**๐ ุชุงุฑูุฎ:** 2025-02-11  
**โ ุงูุญุงูุฉ:** ุฌุงูุฒ ููุงุฎุชุจุงุฑ

